# 네이글 알고리즘 (Nagle Algorithm)
![image](https://github.com/user-attachments/assets/6d00cfc9-697d-499f-83a0-fef7d204a112)
- 컴퓨터 네트워크에서 작은 데이터 패킷의 전송을 줄여 네트워크 효율성을 높이기 위해 설계된 알고리즘
- 작은 패킷을 묶어서 더 큰 패킷으로 만들어 전송함으로써 네트워크의 대역폭 사용을 최적화

## 배경
- TCP 연결에서 데이터는 여러 작은 패킷으로 전송될 수 있습니다. 하지만, 작은 패킷이 너무 많이 전송되면 다음과 같은 문제가 발생합니다.
    - **오버헤드 증가**: 각 패킷에는 헤더가 붙기 때문에, 작은 데이터가 많이 전송되면 헤더로 인해 네트워크 리소스가 낭비됩니다.
    - **네트워크 혼잡**: 많은 수의 작은 패킷이 전송되면 네트워크가 불필요하게 과부하 상태가 될 수 있습니다.

## 동작 원리
- 네이글 알고리즘은 다음과 같은 규칙을 따릅니다.
    - **패킷을 기다려서 병합**: 이전 패킷의 **ACK**가 수신될 때까지 추가 데이터가 생성되더라도 새로운 패킷을 전송하지 않습니다.
    - **병합 조건**: ACK를 기다리는 동안 추가 데이터가 발생하면 이를 기존 데이터와 병합해 하나의 큰 패킷으로 만들어 전송합니다.

## 구체적 작동 과정
- **첫 번째 데이터**: 전송 요청이 발생하면 즉시 첫 번째 패킷을 전송합니다.
- **추가 데이터 발생**:
    - 이전 패킷에 대한 ACK가 도착하지 않은 상태라면, 새로운 데이터를 기존의 버퍼에 저장하고 대기합니다.
    - ACK가 도착하면 버퍼에 저장된 데이터를 하나로 묶어서 전송합니다.

## 장점
- **네트워크 대역폭 최적화**: 작은 패킷을 줄이고 큰 패킷으로 병합해 대역폭 사용 효율을 높입니다.
- **네트워크 혼잡 감소**: 불필요한 작은 패킷 전송을 줄임으로써 네트워크 트래픽을 감소시킵니다.

## 단점
- **지연 증가**: ACK를 기다리는 동안 데이터 전송이 지연될 수 있습니다. 이로 인해 실시간 애플리케이션에서 문제가 발생할 수 있습니다.
- **소형 데이터 전송에 부적합**: 데이터 전송 크기가 작고 전송 주기가 짧은 경우에는 비효율적일 수 있습니다.

## 게임 서버에서 네이글 알고리즘의 사용 여부
### 사용해야 하는 경우
- **데이터 전송 지연이 큰 문제가 아닌 경우**
    - 게임 서버가 실시간성이 중요하지 않은 경우(예: 턴제 게임, 카드 게임 등)
    - 데이터 전송의 효율성이 중요한 경우, 네이글 알고리즘은 네트워크 대역폭을 절약하고 패킷 수를 줄이는데 유용합니다.
- **클라이언트-서버 간 트래픽이 빈번하지 않을 때**
    - 작은 패킷이 자주 발생하지 않고, ACK 응답을 기다릴 수 있는 상황
- **데이터 병합이 가능한 경우**
    - 예를 들어, 주기적인 상태 업데이트가 일정한 주기로 클라이언트에 전송되는 경우, 여러 작은 패킷을 하나로 묶어서 전송하는 데 적합합니다.

### 사용하지 않아야하는 경우
- **실시간성이 중요한 경우**
    - FPS, MOBA, MMORPG 등의 실시간 데이터 전송이 필요한 게임에서 지연(Latency)가 중요하다면, 네이글 알고리즘은 사용하지 않는 것이 일반적입니다.
- **작은 데이터 패킷이 자주 전송되는 경우**
    - 키 입력, 이동 명령, 공격 등의 데이터가 자주 발생하면 네이글 알고리즘으로 인해 지연이 누적될 수 있습니다.

## 네이글 알고리즘 설정
- 네이글 알고리즘은 **TCP_NODELAY** 옵션을 통해 활성화 비활성화할 수 있습니다.

